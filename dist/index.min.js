!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.noreact=e():t.noreact=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="./src/index.ts")}({"./src/MVVM.ts":function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r("./src/diff.ts"),i=r("./src/event-center.ts"),s=r("./src/VNode.ts"),c=r("./src/react.ts"),a=r("./src/refresh.ts"),u=n(r("./src/dev.ts")),h=function(){function t(t){this.$eventRegister={},this.$children=[],this.$isdirty=!1,this.$hasRenderedDom=!1,this.$mountDom=null,this.$isDestroyed=!1,this.$props=null!=t?t:{},this.$watchObject(this.$props),this.$id=c.GetId()}return t.prototype.$didMounted=function(){},t.prototype.$willUnMount=function(){},t.prototype.$emitUp=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(e=this.$root).EmitUp.apply(e,[t].concat(r))},t.prototype.$emitDown=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(e=this.$root).EmitDown.apply(e,[t].concat(r))},t.prototype.$on=function(t,e){this.$eventRegister[t]||(this.$eventRegister[t]=[]),this.$eventRegister[t].push(e),i.RegisterEvent(t,e,this)},t.prototype.$broadcast=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];i.TriggerEvent(t,e,this)},t.prototype.$Trigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.$eventRegister[t];n&&n.forEach(function(t){return t.apply(void 0,e)})},t.prototype.$ToDom=function(){if(this.$isdirty){var t=this.$Render();this.$root=this.$checkNoVNode(t),this.$isdirty=!1}return this.$hasRenderedDom=!0,this.$root||this.$DoRender(),this.$root.ToDom()},t.prototype.$ToHtml=function(){var t=this.$Render();return this.$checkNoVNode(t).ToHtml()},t.prototype.$GetRoot=function(){return this.$root||this.$DoRender(),this.$root},t.prototype.$SetChildren=function(t){this.$children=t},t.prototype.$GetChildren=function(){return this.$children},t.prototype.$Dirty=function(){this.$isdirty||(this.$isdirty=!0,a.InsertQueue(this))},t.prototype.$GetDirty=function(){return this.$isdirty},t.prototype.$ApplyRefresh=function(){var e;if(this.$isdirty){u.default.OnChange("update",[this]),c.React.ChangeMode("shallow");var r=c.React.target;c.React.target=this;var n=this.$Render(),o=this.$checkNoVNode(n);if(c.React.target=r,c.React.ChangeMode("deep"),t.$compareVNode(this.$root,o))this.$useOld(this.$root,o);else{if(this.$hasRenderedDom){var i=o.ToDom(),s=this.$root.GetParent().GetSiblingDom(this.$root);s.isparent?(e=s.dom).append.apply(e,i):i.forEach(function(t){s.dom.parentNode.insertBefore(t,s.dom)}),this.$root.Doms.forEach(function(t){t.remove()})}this.$root.GetParent().isMulti=o.isMulti,o.SetParent(this.$root.GetParent()),this.$root.Destroy();var a=this.$root.GetAllMvvm();a.length>0&&u.default.OnChange("delete",a),this.$root=o,this.$hasRenderedDom&&o.Rendered();var h=o.GetAllMvvm();h.length>0&&u.default.OnChange("new",h,{isparent:!0,id:this.$id})}this.$isdirty=!1}},t.prototype.$DoRender=function(){var t=this,e=[];Object.keys(this).forEach(function(r){r.startsWith("$")||t[r]===t.$props||e.push(r)}),e.length>0&&this.$watchObject(this,e);var r=c.React.target;c.React.target=this;var n=this.$Render();return this.$root=this.$checkNoVNode(n),this.$attachedVNode||(this.$attachedVNode=new s.VNode("custom"),this.$attachedVNode.SetMvvm(this)),this.$attachedVNode.isMulti=this.$root.isMulti,this.$root.SetParent(this.$attachedVNode),c.React.target=r,this.$root},t.prototype.$watchObject=function(e,r){var n=this,o=!(e instanceof c.Ref),i=!(e instanceof s.VNode),a=!(e instanceof t)||r&&r.length>0,u="[object Object]"==toString.call(e)&&o&&i&&a,h="[object Array]"==toString.call(e);if(u||h){var f=[];(r&&r.length>0&&r||Object.keys(e)).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&r.configurable){var o=e[t];Object.defineProperty(e,t,{get:function(){return c.React.target&&f.indexOf(c.React.target)&&f.push(c.React.target),o},set:function(t){t!=o&&(f.forEach(function(t){return t.$Dirty()}),o=t,"[object Array]"==toString.call(o)&&n.$watchArray(o,f),n.$watchObject(o))},configurable:!1,enumerable:!0}),"[object Array]"==toString.call(o)&&n.$watchArray(o,f),n.$watchObject(o)}})}else;},t.prototype.$watchArray=function(t,e){var r=Object.getPrototypeOf(t);if(!r||"noreact"!=r.$marked){var n=this.getArrayProto(t,e);Object.setPrototypeOf(t,n),Object.setPrototypeOf(n,r)}},t.prototype.$useOld=function(t,e){if("custom"==t.GetType()){var r=t.GetMvvm(),n=e.GetMvvm();return r.$resetProps(n.$props),r.$children===n.$children||0==r.$children.length&&0==n.$children.length||(r.$SetChildren(n.$children),r.$isdirty=!0),void(r.$isdirty&&r.$ApplyRefresh())}if("standard"==t.GetType()||"fragment"==t.GetType())return"standard"==t.GetType()&&t.ApplyAttrDiff(e.GetAttrs()),void this.$diff(t.GetChildren(),e.GetChildren(),t);t.GetType()},t.prototype.$IsParentOf=function(t){for(var e=t.$attachedVNode.GetParent();e;){if(e.GetMvvm()==this)return!0;e=e.GetParent()}return!1},t.prototype.$diff=function(e,r,n){var i=this,s=o.Diff(e,r,t.$compareVNode),c=0;s.forEach(function(t){return"old"==t.state?(c++,void i.$useOld(t.oldValue,t.newValue)):"new"==t.state?(t.newValueOrigin?(i.$useOld(t.newValueOrigin,t.newValue),n.InsertVNode(t.newValueOrigin,c,i.$hasRenderedDom)):(i.$hasRenderedDom&&t.newValue.ToDom(),n.InsertVNode(t.newValue,c,i.$hasRenderedDom),i.$devNew(t.newValue,c),i.$hasRenderedDom&&t.newValue.Rendered()),void c++):"delete"==t.state?(n.RemoveVNode(t.oldValue,c,i.$hasRenderedDom&&t.isdeprecated),i.$devDelete(t.oldValue),void(t.isdeprecated&&t.oldValue.Destroy())):void("replace"==t.state&&(n.RemoveVNode(t.oldValue,c,i.$hasRenderedDom&&t.isdeprecated),i.$devDelete(t.oldValue),t.isdeprecated&&t.oldValue.Destroy(),t.newValueOrigin?(i.$useOld(t.newValueOrigin,t.newValue),n.InsertVNode(t.newValueOrigin,c,i.$hasRenderedDom)):(i.$hasRenderedDom&&t.newValue.ToDom(),n.InsertVNode(t.newValue,c,i.$hasRenderedDom),i.$devNew(t.newValue,c),i.$hasRenderedDom&&t.newValue.Rendered()),c++))})},t.prototype.$devDelete=function(t){var e=t.GetAllMvvm();e.length>0&&u.default.OnChange("delete",e)},t.prototype.$devNew=function(t,e){var r=t.GetAllMvvm();if(r.length>0){var n=null,o=t.GetParent();if(o.GetChildren().length-1>e)(n=o.GetChildren()[e+1].GetFirstChildMvvm())&&u.default.OnChange("new",r,{isparent:!1,id:n.$id});n||u.default.OnChange("new",r,{isparent:!0,id:o.GetNearestAncestorMvvm().$id})}},t.prototype.$resetProps=function(t){var e=this;if(this.$props&&"[object Object]"==Object.prototype.toString.call(this.$props)&&t&&"[object Object]"==Object.prototype.toString.call(t)){var r=Object.keys(this.$props),n=Object.keys(t);r.forEach(function(r){-1!=n.indexOf(r)?e.$setProp(r,t[r]):e.$props[r]=void 0}),n.forEach(function(n){-1==r.indexOf(n)&&(e.$props[n]=t[n],e.$watchObject(e.$props,[n]))})}},t.prototype.$setProp=function(t,e){var r=this.$props[t];if("function"!=typeof r||"function"!=typeof e)"[object RegExp]"==Object.prototype.toString.call(r)&&"[object RegExp]"==Object.prototype.toString.call(e)&&r.toString()==e.toString()||(this.$props[t]=e);else{if(void 0!==r.prototype&&void 0!==e.prototype&&"function"==typeof r.toString&&"function"==typeof e.toString&&r.toString()==e.toString())return;this.$props[t]=e}},t.prototype.$checkNoVNode=function(t){if(t instanceof s.VNode)return t;if(t&&"function"==typeof t.toString){var e=t.toString(),r=new s.VNode("text");return r.SetText(e),r.SetAttr("key","$1"),r}throw new Error("$Render function return invalid value")},t.prototype.$Rendered=function(){this.$isDestroyed=!1,this.$root.Rendered(),this.$didMounted()},t.prototype.$Destroy=function(){this.$isDestroyed=!0,this.$willUnMount(),this.$root.Destroy()},t.prototype.$IsDestroyed=function(){return this.$isDestroyed},t.prototype.$AttachVNode=function(t){this.$attachedVNode=t},t.prototype.$AppendTo=function(t){var e;(e="string"==typeof t?document.querySelector(t):t).append.apply(e,this.$ToDom()),this.$mountDom=e,this.$Rendered(),u.default.AddMvvm(this)},t.prototype.$GetMountDom=function(){return this.$mountDom},t.prototype.$GetAttachedVNode=function(){return this.$attachedVNode},t.$compareVNode=function(t,e){return t.GetAttr("key")==e.GetAttr("key")&&(t.GetType()==e.GetType()&&(("custom"!=t.GetType()||t.GetMvvm().constructor==e.GetMvvm().constructor)&&(("standard"!=t.GetType()||t.GetTag()==e.GetTag())&&("text"!=t.GetType()||t.GetText()==e.GetText()))))},t.prototype.$GetProps=function(){return this.$props},t.prototype.getArrayProto=function(t,e){var r=this,n=t.push,o=t.pop,i=t.splice,s=t.shift,c=t.unshift,a=function(n,o,i){e.forEach(function(t){return t.$Dirty()});var s=o.apply(t,Array.prototype.slice.call(i));return"push"!=n&&"unshift"!=n||r.$watchObject(t),s};return{$marked:"noreact",push:function(){return a("push",n,arguments)},pop:function(){return a("pop",o,arguments)},splice:function(){return a("slice",i,arguments)},shift:function(){return a("shift",s,arguments)},unshift:function(){return a("unshift",c,arguments)}}},t}();e.MVVM=h},"./src/VNode.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/attribute.ts"),o=r("./src/react.ts"),i=function(){function t(t){this.tag="",this.text="",this.children=[],this.attrs={},this.parent=null,this.isDestroyed=!1,this.isMulti=!1,this.type=t}return Object.defineProperty(t.prototype,"Doms",{get:function(){if("standard"==this.type||"text"==this.type)return[this.dom];if("fragment"==this.type){var t=[];return this.children.forEach(function(e){t=t.concat(e.Doms)}),t}return"custom"==this.type?this.mvvm.$GetRoot().Doms:void 0},enumerable:!0,configurable:!0}),t.prototype.SetTag=function(t){this.tag=t},t.prototype.GetTag=function(){return this.tag},t.prototype.GetText=function(){return this.text},t.prototype.SetText=function(t){this.text=t},t.prototype.SetMvvm=function(t){this.mvvm=t},t.prototype.GetMvvm=function(){return this.mvvm},t.prototype.GetParent=function(){return this.parent},t.prototype.InsertVNode=function(t,e,r){var n;if(this.children.splice(e,0,t),t.parent=this,r){var o=this.GetSiblingDom(t),i=t.Doms;o.isparent?(n=o.dom).append.apply(n,i):i.forEach(function(t){o.dom.parentNode.insertBefore(t,o.dom)})}},t.prototype.GetSiblingDom=function(t){if("custom"==this.type)return this.parent?this.parent.GetSiblingDom(this):{dom:this.mvvm.$GetMountDom(),isparent:!0};var e=this.children.indexOf(t);for(e++;e<this.children.length;){var r=this.children[e].Doms;if(r.length>0)return{dom:r[0],isparent:!1};e++}return this.isMulti?this.parent.GetSiblingDom(this):{dom:this.dom,isparent:!0}},t.prototype.RemoveVNode=function(t,e,r){if(void 0===r&&(r=!0),this.children.splice(e,1),r){var n=t.Doms;n&&n.forEach(function(t){t.parentNode.removeChild(t)})}},t.prototype.SetChildren=function(t){var e=this;t.forEach(function(t){t.parent=e}),this.children=t},t.prototype.IsDestroyed=function(){return this.isDestroyed},t.prototype.Destroy=function(){this.isDestroyed=!0,"custom"==this.type&&this.mvvm.$Destroy(),this.children.forEach(function(t){t.Destroy()})},t.prototype.GetChildren=function(){return this.children},t.prototype.Rendered=function(){"custom"==this.type&&this.mvvm.$Rendered(),"standard"!=this.type&&"fragment"!=this.type||this.children.forEach(function(t){t.Rendered()}),this.attrs.ref instanceof o.Ref&&("standard"==this.type?this.attrs.ref.current=this.dom:"custom"==this.type&&(this.attrs.ref.current=this.mvvm))},t.prototype.GetType=function(){return this.type},t.prototype.SetAttr=function(t,e){this.attrs[t]=e},t.prototype.GetAttr=function(t){return this.attrs[t]},t.prototype.GetAttrs=function(){return this.attrs},t.prototype.SetParent=function(t){this.parent=t},t.prototype.ApplyAttrDiff=function(t){var e=this;Object.keys(this.attrs).forEach(function(r){var o=n.GetEventAttrName(r),i=null!=o;if(null==t[r])i?e.dom.removeEventListener(o,e.attrs[r]):n.RemoveAttr(e.dom,r,e.attrs[r]);else{if("style"==r&&"[object Object]"==toString.call(e.attrs.style)&&"[object Object]"==toString.call(t.style)){var s=e.attrs.style,c=t.style;return Object.keys(s).forEach(function(t){c[t]?c[t]!=s[t]&&(e.dom.style[t]=c[t]):e.dom.style[t]=""}),void Object.keys(c).forEach(function(t){s[t]||(e.dom.style[t]=c[t])})}i?e.attrs[r]!=t[r]&&(e.dom.removeEventListener(o,e.attrs[r]),e.dom.addEventListener(o,t[r])):e.attrs[r]!=t[r]&&(n.RemoveAttr(e.dom,r,e.attrs[r]),n.ApplyAttr(e.dom,r,t[r]))}}),Object.keys(t).forEach(function(r){var o=n.GetEventAttrName(r),i=null!=o;null==e.attrs[r]&&(i?e.dom.addEventListener(o,t[r]):n.ApplyAttr(e.dom,r,t[r]))}),this.attrs=t},t.prototype.ToHtml=function(){var t=this;if("text"==this.type)return this.text;if("custom"==this.type)return this.mvvm.$ToHtml();if("standard"==this.type){var e=[];return e.push("<"+this.tag),Object.keys(this.attrs).forEach(function(r){var o=n.SerializeAttr(r,t.attrs[r]);o&&e.push(" "+o)}),e.push(">"),this.children.forEach(function(t){var r=t.ToHtml();e.push(r)}),e.push("</"+this.tag+">"),e.join("")}if("fragment"==this.type){var r=[];return this.children.forEach(function(t){var e=t.ToHtml();r.push(e)}),r.join("")}},t.prototype.ToDom=function(){var t=this;if("custom"==this.type)return this.mvvm.$ToDom();if("standard"==this.type){var e=document.createElement(this.tag);return this.dom=e,this.children.forEach(function(t){t.ToDom().forEach(function(t){return e.appendChild(t)})}),Object.keys(this.attrs).forEach(function(r){var o=n.GetEventAttrName(r);o?e.addEventListener(o,t.attrs[r]):n.ApplyAttr(e,r,t.attrs[r])}),[e]}if("fragment"==this.type){var r=[];return this.children.forEach(function(t){var e=t.ToDom();r=r.concat(e)}),r}if("text"==this.type){var o=document.createTextNode(this.text);return this.dom=o,[o]}},t.prototype.EmitUp=function(t){for(var e,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];this.parent&&("custom"==this.parent.type&&(e=this.parent.mvvm).$Trigger.apply(e,[t].concat(n)),(r=this.parent).EmitUp.apply(r,[t].concat(n)))},t.prototype.EmitDown=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.children.forEach(function(r){var n;"custom"==r.type&&(n=r.mvvm).$Trigger.apply(n,[t].concat(e)),r.EmitDown.apply(r,[t].concat(e))})},t.prototype.AttachDom=function(t){var e=this;this.dom=t,Object.keys(this.attrs).forEach(function(r){var o=n.GetEventAttrName(r);o&&t.addEventListener(o,e.attrs[r])})},t.prototype.GetNearestAncestorMvvm=function(){return"custom"==this.type?this.mvvm:this.parent&&this.parent.GetNearestAncestorMvvm()},t.prototype.GetFirstChildMvvm=function(){if("custom"==this.type)return this.mvvm;for(var t=0,e=this.children;t<e.length;t++){var r=e[t].GetFirstChildMvvm();if(r)return r}return null},t.prototype.GetAllMvvm=function(){if("custom"==this.type)return[this.mvvm];if("text"==this.type)return[];if("standard"==this.type||"fragment"==this.type){var t=[];return this.children.forEach(function(e){t=t.concat(e.GetAllMvvm())}),t}return[]},t}();e.VNode=i},"./src/attribute.ts":function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.VNODE_ID="__decorator__";var o=!1;e.ServerRender=function(t){o=t};var i={style:function(t,e){return"[object Object]"==toString.call(e)&&(Object.keys(e).forEach(function(r){t.style[r]=e[r]}),!0)},className:function(t,e){return e instanceof Array?t.setAttribute("class",e.join(" ")):t.setAttribute("class",e),!0},class:function(t,e){return e instanceof Array?t.setAttribute("class",e.join(" ")):t.setAttribute("class",e),!0},key:function(t,e){return!0},ref:function(t,e){return!0},value:function(t,e){return(t instanceof HTMLInputElement||t instanceof HTMLSelectElement)&&(t.value=e,!0)},checked:function(t,e){return t instanceof HTMLInputElement&&(t.checked=e,!0)}},s={style:function(t,e){return"[object Object]"==toString.call(e)&&(Object.keys(e).forEach(function(e){t.style[e]=""}),!0)},className:function(t,e){return t.setAttribute("class",""),!0},key:function(t,e){return!0},value:function(t,e){return t instanceof HTMLInputElement&&(t.value="",!0)}},c=((n={style:function(t){if("[object Object]"==toString.call(t)){var e="";return Object.keys(t).forEach(function(r){e+=r+"="+t[r]+";"}),'style="'+e+'"'}return"style="+t},className:function(t){return t instanceof Array&&(t=t.join(" ")),"class="+t},key:function(t){return""},ref:function(t){return""}})[e.VNODE_ID]=function(t){return o?e.VNODE_ID+"="+t:""},n);e.SerializeAttr=function(t,e){return"[object Function]"==toString.call(e)?"":c[t]?c[t](e):t+"="+e},e.ApplyAttr=function(t,e,r){if(i[e]&&i[e](t,r))return;t.setAttribute(e,r)},e.RemoveAttr=function(t,e,r){if(s[e]&&s[e](t,r))return;t.setAttribute(e,"")},e.GetEventAttrName=function(t){return/^on([A-Z][a-z]+)+$/.test(t)?t.slice(2).toLowerCase():null}},"./src/dev.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=new(function(){function t(){this.roots=[],this.listeners=[]}return t.prototype.Subscribe=function(t,e){-1==this.listeners.indexOf(t)&&(this.roots&&e(this.toJson()),this.listeners.push(t))},t.prototype.AddMvvm=function(t){var e=this;this.roots.push(t),this.listeners.forEach(function(r){r("new",e.getMvvm(t.$GetAttachedVNode()))})},t.prototype.Unsubscribe=function(t){this.listeners=this.listeners.filter(function(e){return e!=t})},t.prototype.toJson=function(){var t=this,e=[];return this.roots&&this.roots.forEach(function(r){e=e.concat(t.getMvvm(r.$GetAttachedVNode()))}),e},t.prototype.getMvvm=function(t){var e=this;if("text"==t.GetType())return[];if("standard"==t.GetType()||"fragment"==t.GetType()){var r=[];return t.GetChildren().forEach(function(t){r=r.concat(e.getMvvm(t))}),r}if("custom"==t.GetType()){var n=t.GetMvvm(),o=n.constructor.name,i={};return Object.keys(n).forEach(function(t){(!t.startsWith("$")&&n[t]!==n.$GetProps()||"$id"==t)&&(i[t]=n[t])}),[{name:o,data:i,props:t.GetMvvm().$GetProps(),children:this.getMvvm(t.GetMvvm().$GetRoot())}]}throw new Error("vnode type error")},t.prototype.OnChange=function(t,e,r){var n=this,o=[];e.forEach(function(e){var r={name:e.constructor.name,props:e.$GetProps(),data:{},children:[]};Object.keys(e).forEach(function(t){(!t.startsWith("$")&&e[t]!==e.$GetProps()||"$id"==t)&&(r.data[t]=e[t])}),"new"==t&&(r.children=n.getMvvm(e.$GetRoot())),o.push(r)}),this.listeners.forEach(function(e){e(t,o,r)})},t}());window.__noreact_dev=n,e.default=n},"./src/diff.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Diff=function(t,e,r){var n={},o={},i=function(t,e){for(var r=[],n=0;n<=t.length;n++){for(var o=[],i=0;i<=e.length;i++)0!=n?0!=i?o.push({value:-1,fromRow:-1,fromColumn:-1}):o.push({value:n,fromRow:n-1,fromColumn:0}):o.push({value:i,fromRow:0,fromColumn:i-1});r.push(o)}return r}(t,e);!function t(e,r,n,o,i,s){var c=e[r.length][n.length];if(-1!=c.value)return c.value;var a=0,u=o(r[r.length-1],n[n.length-1]);u?(a=0,i[r.length-1]=n.length-1,s[n.length-1]=r.length-1):a=1;var h=t(e,r.slice(0,r.length-1),n,o,i,s)+1,f=t(e,r,n.slice(0,n.length-1),o,i,s)+1,p=t(e,r.slice(0,r.length-1),n.slice(0,n.length-1),o,i,s)+a,l=Math.min(h,f,p);return c.value=l,l==h?(c.fromRow=r.length-1,c.fromColumn=n.length):l==f?(c.fromRow=r.length,c.fromColumn=n.length-1):(c.fromRow=r.length-1,c.fromColumn=n.length-1),c.value}(i,t,e,r,n,o);var s=function(t,e,r,n,o){for(var i=r.length,s=e.length,c=[];0!=s||0!=i;){var a=t[s][i];a.fromColumn!=i-1||a.fromRow!=s-1?a.fromColumn!=i||a.fromRow!=s-1?a.fromColumn!=i-1||a.fromRow!=s||(c.push({newValue:r[i-1],state:"new",newValueOrigin:e[o[i-1]]}),i--):(c.push({oldValue:e[s-1],state:"delete",isdeprecated:null==n[s-1]}),s--):(a.value!=t[s-1][i-1].value?c.push({oldValue:e[s-1],isdeprecated:null==n[s-1],state:"replace",newValue:r[i-1],newValueOrigin:e[o[i-1]]}):c.push({oldValue:e[s-1],state:"old",newValue:r[i-1]}),s--,i--)}return c}(i,t,e,n,o);return s.reverse(),s}},"./src/event-center.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};e.RegisterEvent=function(t,e,r){n[t]||(n[t]=[]),n[t].push({cb:e,mvvm:r})},e.TriggerEvent=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];n[t]&&(n[t]=n[t].filter(function(t){return!t.mvvm.$IsDestroyed()}),n[t].forEach(function(t){t.cb.apply(t,e)}))}},"./src/index.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/MVVM.ts");e.MVVM=n.MVVM;var o=r("./src/react.ts");e.React=o.React,e.Ref=o.Ref,e.Fragment=o.Fragment;var i=r("./src/VNode.ts");e.VNode=i.VNode;var s=r("./src/dev.ts");e.Dev=s.default},"./src/react.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/VNode.ts"),o=r("./src/MVVM.ts"),i=(new Function("try {return this===window;}catch(e){ return false;}"),function(){function t(){this.mode="deep"}return t.prototype.createElement=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var c=[];if(this.flatten("$",r,c),"string"==typeof t){var a=new n.VNode("standard");return a.SetTag(t),a.isMulti=!1,null!=e&&Object.keys(e).forEach(function(t){a.SetAttr(t,e[t])}),a.SetChildren(c),a}if(t==s){var u=new n.VNode("fragment");return u.isMulti=!0,u.SetChildren(c),null!=e&&Object.keys(e).forEach(function(t){u.SetAttr(t,e[t])}),u}if(t.prototype instanceof o.MVVM){var h=new n.VNode("custom"),f=new t(e);if(h.SetMvvm(f),f.$SetChildren(c),f.$AttachVNode(h),"deep"==this.mode){var p=f.$DoRender();h.isMulti=p.isMulti}return null!=e&&Object.keys(e).forEach(function(t){h.SetAttr(t,e[t])}),h}if("function"==typeof t)return t(e)},t.prototype.flatten=function(t,e,r){var o=this;e.forEach(function(e,i){if(null!=e)if(e instanceof Array)o.flatten(t+i+"_",e,r);else if(e instanceof n.VNode){null!=e.GetAttr("key")?r.push(e):(e.SetAttr("key",t+i),r.push(e))}else{var s=new n.VNode("text");s.SetText(e+""),s.SetAttr("key",t+i),r.push(s)}})},t.prototype.ChangeMode=function(t){this.mode=t},t}()),s=function(){return function(){}}();e.Fragment=s;var c=function(){return function(){}}();e.Ref=c,e.React=new i;var a=0;e.GetId=function(){return a++}},"./src/refresh.ts":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=[],i=[],s=10,c=0;e.InsertQueue=function(t){-1==o.indexOf(t)&&(o.push(t),!n&&o.length>0&&(n=new Promise(function(t,e){t()}).then(function(){i=o,o=[],c=0,function(){for(;;){if(i.sort(function(t,e){return t.$IsParentOf(e)?-1:e.$IsParentOf(t)?1:0}),c>s)throw new Error("refresh loop more than "+s);if(c++,i.forEach(function(t){!t.$IsDestroyed()&&t.$GetDirty()&&t.$ApplyRefresh()}),0==o.length)break;i=o,o=[]}}(),n=null})))}}})});
//# sourceMappingURL=index.min.js.map